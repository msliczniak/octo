: main
jump init

:org 0x300
: init

# high nibble of max RAM
# 0x10 0x1000 4096
# 0x0c 0x0c00 3072
# 0x08 0x0800 2048
i := 0xeb
load v0

# default screen uses upper two pages of mem
v0 -= 2
v8 := v0

i := code
load v7

v5 := v8
i := 0x2b1
save v7

# init completed, patch for reset
i := jump_start
load v1

i := init
save v1

: jump_start
jump start

:org 0x400

: code
# alternate page
# 0x00		# IDL #	already zero
0xf8 0x4	# LDI
0xbb			# PHI RB
# default page
0x00		# IDL
0xf8 0x4	# LDI
0xbb			# PHI RB
0xd4		# SEP R4

# 0b10000000 0 0 0 0 0 0 0
 0b1000000 0 0 0 0 0 0 0
  0b100000 0 0 0 0 0 0 0
   0b10000 0 0 0 0 0 0 0
    0b1000 0 0 0 0 0 0 0
     0b100 0 0 0 0 0 0 0
      0b10 0 0 0 0 0 0 0
       0b1 0 0 0 0 0 0 0

0 0b10000000 0 0 0 0 0 0
0  0b1000000 0 0 0 0 0 0
0   0b100000 0 0 0 0 0 0
0    0b10000 0 0 0 0 0 0
0     0b1000 0 0 0 0 0 0
0      0b100 0 0 0 0 0 0
0       0b10 0 0 0 0 0 0
0        0b1 0 0 0 0 0 0

0 0 0b10000000 0 0 0 0 0
0 0  0b1000000 0 0 0 0 0
0 0   0b100000 0 0 0 0 0
0 0    0b10000 0 0 0 0 0
0 0     0b1000 0 0 0 0 0
0 0      0b100 0 0 0 0 0
0 0       0b10 0 0 0 0 0
0 0        0b1 0 0 0 0 0

0 0 0 0b10000000 0 0 0 0 
0 0 0  0b1000000 0 0 0 0
0 0 0   0b100000 0 0 0 0
0 0 0    0b10000 0 0 0 0
0 0 0     0b1000 0 0 0 0
0 0 0      0b100 0 0 0 0
0 0 0       0b10 0 0 0 0
0 0 0        0b1 0 0 0 0

0 0 0 0 0b10000000 0 0 0
0 0 0 0  0b1000000 0 0 0
0 0 0 0   0b100000 0 0 0
0 0 0 0    0b10000 0 0 0
0 0 0 0     0b1000 0 0 0
0 0 0 0      0b100 0 0 0
0 0 0 0       0b10 0 0 0
0 0 0 0        0b1 0 0 0
        
0 0 0 0 0 0b10000000 0 0
0 0 0 0 0  0b1000000 0 0
0 0 0 0 0   0b100000 0 0
0 0 0 0 0    0b10000 0 0
0 0 0 0 0     0b1000 0 0
0 0 0 0 0      0b100 0 0
0 0 0 0 0       0b10 0 0
0 0 0 0 0        0b1 0 0
        
0 0 0 0 0 0 0b10000000 0
0 0 0 0 0 0  0b1000000 0
0 0 0 0 0 0   0b100000 0
0 0 0 0 0 0    0b10000 0
0 0 0 0 0 0     0b1000 0
0 0 0 0 0 0      0b100 0
0 0 0 0 0 0       0b10 0
0 0 0 0 0 0        0b1 0
        
0 0 0 0 0 0 0 0b10000000 
0 0 0 0 0 0 0  0b1000000
0 0 0 0 0 0 0   0b100000
0 0 0 0 0 0 0    0b10000
0 0 0 0 0 0 0     0b1000
0 0 0 0 0 0 0      0b100
0 0 0 0 0 0 0       0b10
0 0 0 0 0 0 0        0b1

:org 0x600

: start

v1 := 8
v2 := 16
v3 := 24
v4 := 32
v5 := 40
v6 := 48

v7 := 10
v8 := 25
v9 := 40

i := line
v0 := 55
sprite v1 v0 1
sprite v2 v0 1
sprite v3 v0 1
sprite v4 v0 1
sprite v5 v0 1
sprite v6 v0 1

i := shroom0-00
sprite v1 v7 15
i := shroom0-01
sprite v2 v7 15
i := shroom0-02
sprite v3 v7 15
i := shroom0-03
sprite v4 v7 15
i := shroom0-04
sprite v5 v7 15
i := shroom0-05
sprite v6 v7 15

i := shroom0-06
sprite v1 v8 15
i := shroom0-07
sprite v2 v8 15
i := shroom0-08
sprite v3 v8 15
i := shroom0-09
sprite v4 v8 15
i := shroom0-10
sprite v5 v8 15
i := shroom0-11
sprite v6 v8 15

i := shroom0-12
sprite v1 v9 15
i := shroom0-13
sprite v2 v9 15
i := shroom0-14
sprite v3 v9 15
i := shroom0-15
sprite v4 v9 15
i := shroom0-16
sprite v5 v9 15
i := shroom0-17
sprite v6 v9 15

: forever
#jump forever

# two frames
0x02 0xb0

jump forever

: line
255

# $ ./slice.sh shroom0
# $ for i in shroom0-*[01]?.pbm; do echo ': '`basename $i .pbm`; tail -15 "$i" | tr -d ' ' | sed 's/^/0b/'; echo; done
: shroom0-00
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000111
0b00000111
0b00000111
0b00000111
0b00000111
0b00000111

: shroom0-01
0b00000000
0b00000000
0b00000000
0b00011111
0b00011111
0b00011111
0b11100000
0b11100000
0b11100000
0b00000011
0b00000011
0b00000011
0b00011111
0b00011111
0b00011111

: shroom0-02
0b01111111
0b01111111
0b01111111
0b11111111
0b11111111
0b11111111
0b01111111
0b01111111
0b01111111
0b11111111
0b11111111
0b11111111
0b10000000
0b10000000
0b10000000

: shroom0-03
0b11111111
0b11111111
0b11111111
0b11111000
0b11111000
0b11111000
0b11111000
0b11111000
0b11111000
0b11111111
0b11111111
0b11111111
0b00000111
0b00000111
0b00000111

: shroom0-04
0b11100000
0b11100000
0b11100000
0b00011111
0b00011111
0b00011111
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b11100000
0b11100000
0b11100000

: shroom0-05
0b00000001
0b00000001
0b00000001
0b10000001
0b10000001
0b10000001
0b01110001
0b01110001
0b01110001
0b00001111
0b00001111
0b00001111
0b00001111
0b00001111
0b00001111

: shroom0-06
0b00111111
0b00111111
0b00111111
0b00111111
0b00111111
0b00111111
0b00111000
0b00111000
0b00111000
0b00111000
0b00111000
0b00111000
0b00111000
0b00111000
0b00111000

: shroom0-07
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b00011111
0b00011111
0b00011111
0b00011111
0b00011111
0b00011111

: shroom0-08
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b10000000
0b10000000
0b10000000
0b11111111
0b11111111
0b11111111

: shroom0-09
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000111
0b00000111
0b00000111
0b11111111
0b11111111
0b11111111

: shroom0-10
0b11111111
0b11111111
0b11111111
0b11111100
0b11111100
0b11111100
0b11100000
0b11100000
0b11100000
0b11100000
0b11100000
0b11100000
0b11111100
0b11111100
0b11111100

: shroom0-11
0b11111111
0b11111111
0b11111111
0b00001111
0b00001111
0b00001111
0b00000001
0b00000001
0b00000001
0b00000001
0b00000001
0b00000001
0b00001111
0b00001111
0b00001111

: shroom0-12
0b00111000
0b00111000
0b00111000
0b00000111
0b00000111
0b00000111
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroom0-13
0b11111111
0b11111111
0b11111111
0b11111100
0b11111100
0b11111100
0b11100000
0b11100000
0b11100000
0b11100000
0b11100000
0b11100000
0b00011100
0b00011100
0b00011100

: shroom0-14
0b11111111
0b11111111
0b11111111
0b00001110
0b00001110
0b00001110
0b00001110
0b00001110
0b00001110
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroom0-15
0b11111111
0b11111111
0b11111111
0b00000111
0b00000111
0b00000111
0b00000111
0b00000111
0b00000111
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroom0-16
0b11111111
0b11111111
0b11111111
0b00000011
0b00000011
0b00000011
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000011
0b00000011
0b00000011

: shroom0-17
0b11111111
0b11111111
0b11111111
0b11111111
0b11111111
0b11111111
0b01110001
0b01110001
0b01110001
0b01110001
0b01110001
0b01110001
0b10000001
0b10000001
0b10000001

# $ convert shroom0.pbm shroom1.pbm -compose Darken -composite -compress None -strip shroomx.pbm
# $ ./slice.sh shroomx
# $ for i in shroomx-*[01]?.pbm; do echo ': '`basename $i .pbm`; tail -15 "$i" | tr -d ' ' | sed 's/^/0b/'; echo; done
: shroomx-00
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroomx-01
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000011
0b00000011
0b00000011
0b00011111
0b00011111
0b00011111

: shroomx-02
0b00000000
0b00000000
0b00000000
0b01111111
0b01111111
0b01111111
0b01111111
0b01111111
0b01111111
0b11111111
0b11111111
0b11111111
0b10000000
0b10000000
0b10000000

: shroomx-03
0b00000000
0b00000000
0b00000000
0b11111000
0b11111000
0b11111000
0b11111000
0b11111000
0b11111000
0b11111111
0b11111111
0b11111111
0b00000111
0b00000111
0b00000111

: shroomx-04
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b11100000
0b11100000
0b11100000

: shroomx-05
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroomx-06
0b00000111
0b00000111
0b00000111
0b00000111
0b00000111
0b00000111
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroomx-07
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b11111100
0b00011111
0b00011111
0b00011111
0b00011111
0b00011111
0b00011111

: shroomx-08
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b10000000
0b10000000
0b10000000
0b11111111
0b11111111
0b11111111

: shroomx-09
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000111
0b00000111
0b00000111
0b11111111
0b11111111
0b11111111

: shroomx-10
0b11111111
0b11111111
0b11111111
0b11111100
0b11111100
0b11111100
0b11100000
0b11100000
0b11100000
0b11100000
0b11100000
0b11100000
0b11111100
0b11111100
0b11111100

: shroomx-11
0b11111110
0b11111110
0b11111110
0b00001110
0b00001110
0b00001110
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00001110
0b00001110
0b00001110

: shroomx-12
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroomx-13
0b11111100
0b11111100
0b11111100
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroomx-14
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroomx-15
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroomx-16
0b00000011
0b00000011
0b00000011
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000

: shroomx-17
0b11111110
0b11111110
0b11111110
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
0b00000000
